{% include 'header.html' %}
<section id="challenge-info">
    <div>
        <p>Active Challenge</p>
        <h2>{{ challenge.title }}</h2>
        <p>{{ challenge.description }}</p>
        <a href="/challenges/{{challenge.id}}/create-submission" role="button">Post Your Submission</a>
    </div>
    <div id = "time-info">
        <h1 id = "days-left"></h1>
        <h3>Days Left</h3>
        <div id = "progress-bar-info">
            <progress id="progress-bar" data-start="{{ challenge.start }}" data-end="{{ challenge.end }}"></progress>
            <div>
                <p id = "start-date"></p>
                <p id = "end-date"></p>
            </div>
        </div>
    </div>
</section>

<section id="submissions">
    <h4>Submissions</h4>
    {{challenge.submissions}}
</section>

<script>
    const days_left_heading = document.getElementById("days-left");
    const progress_bar = document.getElementById("progress-bar");
    const start_date_tag = document.getElementById("start-date");
    const end_date_tag = document.getElementById("end-date");

    const start_date = new Date(progress_bar.getAttribute("data-start"));
    const end_date = new Date(progress_bar.getAttribute("data-end"));
    const total_days = Math.ceil((end_date - start_date)/86400000) + 1;
    const days_elapsed = Math.floor((Date.now() - start_date)/86400000);
    const days_left = total_days - days_elapsed;

    progress_bar.value = days_elapsed.toString();
    progress_bar.max = total_days.toString();
    days_left_heading.textContent = days_left.toString();
    start_date_tag.textContent = start_date.toDateString();
    end_date_tag.textContent = end_date.toDateString();
</script>
{% include 'footer.html' %}